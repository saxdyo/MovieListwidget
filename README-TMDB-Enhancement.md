# TMDBæ•°æ®æ‹‰å–å’Œæ¨ªç‰ˆæµ·æŠ¥ç”Ÿæˆç³»ç»Ÿ

## æ¦‚è¿°

è¿™ä¸ªå¢å¼ºçš„TMDBæ•°æ®å¤„ç†ç³»ç»Ÿä¸ºMovie List Widgetæä¾›äº†å¼ºå¤§çš„çƒ­é—¨æ•°æ®æ‹‰å–å’Œé«˜è´¨é‡æ¨ªç‰ˆæµ·æŠ¥ç”ŸæˆåŠŸèƒ½ã€‚ç³»ç»Ÿæ”¯æŒå¤šç§å°ºå¯¸çš„æ¨ªç‰ˆæµ·æŠ¥ã€æ™ºèƒ½ç¼“å­˜ã€æ•°æ®è´¨é‡ä¼˜åŒ–å’Œå¸¦æ ‡é¢˜å åŠ æ•ˆæœã€‚

## ä¸»è¦ç‰¹æ€§

### ğŸ–¼ï¸ æ¨ªç‰ˆæµ·æŠ¥åŠŸèƒ½
- **å¤šå°ºå¯¸æ”¯æŒ**: w300, w780, w1280, original
- **æ™ºèƒ½å°ºå¯¸é€‰æ‹©**: æ ¹æ®è®¾å¤‡å±å¹•è‡ªåŠ¨é€‰æ‹©æœ€ä½³å°ºå¯¸
- **æ ‡é¢˜å åŠ æ•ˆæœ**: CSSæ”¯æŒçš„æ ‡é¢˜è¦†ç›–å±‚
- **è´¨é‡è¯„ä¼°**: è‡ªåŠ¨è¯„ä¼°å’Œä¼˜åŒ–æµ·æŠ¥è´¨é‡

### ğŸš€ æ•°æ®å¤„ç†å¢å¼º
- **å¤šæ•°æ®æº**: æ”¯æŒé¢„å¤„ç†æ•°æ®å’Œå®æ—¶APIé™çº§
- **æ™ºèƒ½ç¼“å­˜**: 30åˆ†é’Ÿæ™ºèƒ½ç¼“å­˜æœºåˆ¶
- **ä¸­æ–‡ä¼˜å…ˆ**: ä¼˜å…ˆæ˜¾ç¤ºä¸­æ–‡æ ‡é¢˜å’Œç®€ä»‹
- **å†…å®¹è¿‡æ»¤**: è‡ªåŠ¨è¿‡æ»¤ç»¼è‰ºã€çºªå½•ç‰‡ç­‰ä¸éœ€è¦çš„å†…å®¹

### ğŸ“Š æ•°æ®æ¥æº
- ä»Šæ—¥çƒ­é—¨å½±è§†
- æœ¬å‘¨çƒ­é—¨å½±è§†  
- çƒ­é—¨ç”µå½±
- çƒ­é—¨å‰§é›†

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Widget Interface            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Enhanced Data Loader           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚ Preprocess  â”‚  â”‚   Real-time     â”‚ â”‚
â”‚    â”‚ Data Source â”‚  â”‚   TMDB API      â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Backdrop Tools              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Smart Size â”‚ â”‚ Quality  â”‚ â”‚  Cache   â”‚ â”‚
â”‚  â”‚ Selection â”‚ â”‚ Optimizerâ”‚ â”‚ Manager  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿå¼€å§‹

### 1. åŸºç¡€ä½¿ç”¨

```javascript
// è·å–ä»Šæ—¥çƒ­é—¨ï¼ˆè‡ªåŠ¨ä½¿ç”¨æ¨ªç‰ˆæµ·æŠ¥ï¼‰
const todayMovies = await loadTodayGlobalMedia({
    language: "zh-CN"
});

// æ¯ä¸ªé¡¹ç›®åŒ…å«å¤šç§å°ºå¯¸çš„æ¨ªç‰ˆæµ·æŠ¥
todayMovies.forEach(item => {
    console.log(item.title);
    console.log(item.backdropPath);     // ä¸»è¦æ¨ªç‰ˆæµ·æŠ¥ (w1280)
    console.log(item.backdropHD);       // é«˜æ¸…æ¨ªç‰ˆæµ·æŠ¥ (original)
    console.log(item.backdrop780);      // ä¸­ç­‰å°ºå¯¸æ¨ªç‰ˆæµ·æŠ¥ (w780)
});
```

### 2. è‡ªå®šä¹‰æ¨ªç‰ˆæµ·æŠ¥

```javascript
// æ™ºèƒ½æ¨ªç‰ˆæµ·æŠ¥ç”Ÿæˆ
const backdropUrl = createSmartBackdropUrl(item, 'auto');

// å¸¦æ ‡é¢˜å åŠ çš„æ¨ªç‰ˆæµ·æŠ¥
const backdropWithTitle = generateBackdropWithTitleOverlay(item, {
    titlePosition: 'bottom-left',
    titleColor: '#ffffff',
    backgroundColor: 'rgba(0, 0, 0, 0.6)',
    fontSize: '24px'
});
```

### 3. æ‰¹é‡å¤„ç†æ¨ªç‰ˆæµ·æŠ¥

```javascript
// æ‰¹é‡å¤„ç†å¤šä¸ªé¡¹ç›®çš„æ¨ªç‰ˆæµ·æŠ¥
const processedBackdrops = await batchProcessBackdrops(items, {
    enableTitleOverlay: true,
    preferredSize: 'large',
    includeMetadata: true
});
```

## æ•°æ®ç”Ÿæˆå™¨ä½¿ç”¨

### 1. å®‰è£…å’Œé…ç½®

```bash
# å…‹éš†é¡¹ç›®
git clone <your-repo>
cd <your-repo>

# è®¾ç½®APIå¯†é’¥ï¼ˆåœ¨generate-tmdb-data.jsä¸­ï¼‰
const API_KEY = 'your_tmdb_api_key_here';
```

### 2. ç”Ÿæˆé¢„å¤„ç†æ•°æ®

```bash
# è¿è¡Œæ•°æ®ç”Ÿæˆå™¨
node generate-tmdb-data.js
```

ç”Ÿæˆçš„æ•°æ®å°†ä¿å­˜åˆ° `data/TMDB_Trending.json`ï¼ŒåŒ…å«ï¼š

```json
{
  "generated_at": "2024-01-01T00:00:00.000Z",
  "data_version": "2.0",
  "description": "å¸¦æ ‡é¢˜æ¨ªç‰ˆæµ·æŠ¥çš„TMDBçƒ­é—¨æ•°æ®",
  "today_global": [...],
  "week_global_all": [...],
  "popular_movies": [...],
  "popular_tv_shows": [...],
  "stats": {
    "today_count": 20,
    "week_count": 20,
    "movies_count": 15,
    "tv_shows_count": 15,
    "total_count": 70
  }
}
```

### 3. éƒ¨ç½²æ•°æ®æ–‡ä»¶

å°†ç”Ÿæˆçš„ `TMDB_Trending.json` ä¸Šä¼ åˆ°ä½ çš„GitHubä»“åº“çš„ `data/` ç›®å½•ï¼Œç„¶åæ›´æ–° `Move_list 2.js` ä¸­çš„æ•°æ®æºURLã€‚

## APIå‚è€ƒ

### ä¸»è¦å‡½æ•°

#### `loadTmdbTrendingData()`
åŠ è½½TMDBçƒ­é—¨æ•°æ®ï¼Œä¼˜å…ˆä½¿ç”¨é¢„å¤„ç†æ•°æ®æºï¼Œé™çº§åˆ°å®æ—¶APIã€‚

#### `generateEnhancedTrendingData()`
ä½¿ç”¨å®æ—¶TMDB APIç”Ÿæˆå¢å¼ºçš„çƒ­é—¨æ•°æ®ã€‚

#### `processEnhancedMediaItems(items, genreMap, forceType)`
å¤„ç†åª’ä½“é¡¹ç›®ï¼Œç”Ÿæˆå¤šç§å°ºå¯¸çš„å›¾ç‰‡URLå’Œå¢å¼ºçš„å…ƒæ•°æ®ã€‚

#### `createEnhancedWidgetItem(item)`
å°†å¤„ç†åçš„æ•°æ®è½¬æ¢ä¸ºWidgetæ ‡å‡†æ ¼å¼ã€‚

### æ¨ªç‰ˆæµ·æŠ¥å·¥å…·

#### `createSmartBackdropUrl(item, preferredSize)`
- `item`: åª’ä½“é¡¹ç›®å¯¹è±¡
- `preferredSize`: 'auto' | 'small' | 'medium' | 'large' | 'original'

#### `generateBackdropWithTitleOverlay(item, options)`
é€‰é¡¹å‚æ•°ï¼š
- `titlePosition`: 'bottom-left' | 'bottom-right' | 'top-left' | 'top-right'
- `titleColor`: CSSé¢œè‰²å€¼
- `backgroundColor`: CSSèƒŒæ™¯é¢œè‰²
- `fontSize`: CSSå­—ä½“å¤§å°
- `fontWeight`: CSSå­—ä½“é‡é‡

#### `batchProcessBackdrops(items, options)`
æ‰¹é‡å¤„ç†é€‰é¡¹ï¼š
- `enableTitleOverlay`: æ˜¯å¦å¯ç”¨æ ‡é¢˜å åŠ 
- `preferredSize`: é¦–é€‰å°ºå¯¸
- `includeMetadata`: æ˜¯å¦åŒ…å«å…ƒæ•°æ®

### ç¼“å­˜ç®¡ç†

#### `cacheBackdrop(key, data)`
ç¼“å­˜æ¨ªç‰ˆæµ·æŠ¥æ•°æ®ã€‚

#### `getCachedBackdrop(key, maxAge)`
è·å–ç¼“å­˜çš„æ¨ªç‰ˆæµ·æŠ¥æ•°æ®ã€‚

## é…ç½®é€‰é¡¹

### æ•°æ®æºé…ç½®

```javascript
// åœ¨ loadTmdbTrendingData() ä¸­é…ç½®å¤šä¸ªæ•°æ®æº
const dataSources = [
    "https://raw.githubusercontent.com/saxdyo/MovieListwidget/main/data/TMDB_Trending.json",
    "https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/data/TMDB_Trending.json"
];
```

### ç¼“å­˜é…ç½®

```javascript
// ç¼“å­˜æŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
const TRENDING_CACHE_DURATION = 30 * 60 * 1000; // 30åˆ†é’Ÿ

// æ¨ªç‰ˆæµ·æŠ¥ç¼“å­˜å¤§å°
const BACKDROP_CACHE_SIZE = 100;
```

### å†…å®¹è¿‡æ»¤é…ç½®

```javascript
// è¿‡æ»¤çš„ç±»å‹ID
const unwantedGenreIds = [10764, 10767, 10763, 99]; // çœŸäººç§€ã€è„±å£ç§€ã€æ–°é—»ã€çºªå½•ç‰‡

// è¿‡æ»¤çš„å…³é”®è¯
const unwantedKeywords = ['ç»¼è‰º', 'çœŸäººç§€', 'è„±å£ç§€', 'è®¿è°ˆ', 'èŠ‚ç›®', 'çºªå½•ç‰‡', 'æ–°é—»', 'çŸ­å‰§'];
```

## æ¨ªç‰ˆæµ·æŠ¥å°ºå¯¸è¯´æ˜

| å°ºå¯¸æ ‡è¯† | TMDBè§„æ ¼ | å®½åº¦ | é€‚ç”¨åœºæ™¯ |
|---------|----------|------|----------|
| w300 | w300 | 300px | ç§»åŠ¨è®¾å¤‡å°å›¾ |
| w780 | w780 | 780px | å¹³æ¿å’Œä¸­ç­‰å±å¹• |
| w1280 | w1280 | 1280px | æ¡Œé¢å’Œå¤§å±å¹• |
| original | original | åŸå§‹å°ºå¯¸ | é«˜æ¸…æ˜¾ç¤º |

## æ•°æ®ç»“æ„

### å¢å¼ºçš„åª’ä½“é¡¹ç›®

```javascript
{
  id: 12345,
  title: "ç”µå½±æ ‡é¢˜",
  genreTitle: "åŠ¨ä½œâ€¢ç§‘å¹»",
  rating: 8.5,
  overview: "ç”µå½±ç®€ä»‹...",
  release_date: "2024-01-01",
  year: 2024,
  
  // æµ·æŠ¥URL
  poster_url: "https://image.tmdb.org/t/p/w500/poster.jpg",
  poster_hd: "https://image.tmdb.org/t/p/w780/poster.jpg",
  
  // æ¨ªç‰ˆæµ·æŠ¥URLï¼ˆå¤šç§å°ºå¯¸ï¼‰
  title_backdrop: "https://image.tmdb.org/t/p/w1280/backdrop.jpg",
  title_backdrop_hd: "https://image.tmdb.org/t/p/original/backdrop.jpg",
  backdrop_w780: "https://image.tmdb.org/t/p/w780/backdrop.jpg",
  
  // é™„åŠ ä¿¡æ¯
  type: "movie",
  popularity: 1234.5,
  vote_count: 5678,
  adult: false,
  original_language: "en"
}
```

## æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥
- **å†…å­˜ç¼“å­˜**: çƒ­é—¨æ•°æ®ç¼“å­˜30åˆ†é’Ÿ
- **æ¨ªç‰ˆæµ·æŠ¥ç¼“å­˜**: LRUç¼“å­˜ï¼Œæœ€å¤š100é¡¹
- **æ™ºèƒ½é¢„åŠ è½½**: æ ¹æ®ç”¨æˆ·è¡Œä¸ºé¢„åŠ è½½ç›¸å…³æ•°æ®

### ç½‘ç»œä¼˜åŒ–
- **å¹¶è¡Œè¯·æ±‚**: åŒæ—¶è¯·æ±‚å¤šä¸ªæ•°æ®æº
- **é™çº§æœºåˆ¶**: é¢„å¤„ç†æ•°æ® â†’ å®æ—¶API â†’ ç¼“å­˜æ•°æ®
- **è¶…æ—¶æ§åˆ¶**: 8ç§’è¶…æ—¶ï¼Œå¿«é€Ÿé™çº§

### å›¾ç‰‡ä¼˜åŒ–
- **æ™ºèƒ½å°ºå¯¸**: æ ¹æ®è®¾å¤‡è‡ªåŠ¨é€‰æ‹©æœ€ä½³å°ºå¯¸
- **è´¨é‡è¯„ä¼°**: åŸºäºäººæ°”ã€è¯„åˆ†ã€æŠ•ç¥¨æ•°ç­‰æŒ‡æ ‡
- **æ‡’åŠ è½½æ”¯æŒ**: æä¾›å¤šç§å°ºå¯¸ä¾¿äºå®ç°æ‡’åŠ è½½

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®è·å–å¤±è´¥**
   - æ£€æŸ¥TMDB APIå¯†é’¥æ˜¯å¦æœ‰æ•ˆ
   - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
   - æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

2. **æ¨ªç‰ˆæµ·æŠ¥æ˜¾ç¤ºé—®é¢˜**
   - æ£€æŸ¥å›¾ç‰‡URLæ˜¯å¦æ­£ç¡®
   - ç¡®è®¤TMDBå›¾ç‰‡æœåŠ¡å¯è®¿é—®
   - å°è¯•ä¸åŒçš„å°ºå¯¸é€‰é¡¹

3. **ç¼“å­˜é—®é¢˜**
   - æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
   - é‡å¯åº”ç”¨ç¨‹åº
   - æ£€æŸ¥ç¼“å­˜é…ç½®

### è°ƒè¯•æ¨¡å¼

```javascript
// å¯ç”¨è°ƒè¯•æ—¥å¿—
const DEBUG_MODE = true;

if (DEBUG_MODE) {
    console.log("[è°ƒè¯•] æ•°æ®åŠ è½½çŠ¶æ€");
    console.log("[è°ƒè¯•] æ¨ªç‰ˆæµ·æŠ¥URL:", backdropUrl);
    console.log("[è°ƒè¯•] ç¼“å­˜å‘½ä¸­:", cacheHit);
}
```

## æ›´æ–°æ—¥å¿—

### v2.0.0 (å½“å‰ç‰ˆæœ¬)
- âœ¨ æ–°å¢å¢å¼ºçš„TMDBæ•°æ®æ‹‰å–ç³»ç»Ÿ
- ğŸ–¼ï¸ æ–°å¢å¤šå°ºå¯¸æ¨ªç‰ˆæµ·æŠ¥æ”¯æŒ
- ğŸ’¾ æ–°å¢æ™ºèƒ½ç¼“å­˜æœºåˆ¶
- ğŸ¨ æ–°å¢æ ‡é¢˜å åŠ æ•ˆæœ
- ğŸš€ æ–°å¢è´¨é‡ä¼˜åŒ–å™¨
- ğŸ“Š æ–°å¢æ•°æ®ç”Ÿæˆå™¨å·¥å…·

### v1.0.0
- åŸºç¡€TMDBæ•°æ®æ‹‰å–åŠŸèƒ½
- ç®€å•æ¨ªç‰ˆæµ·æŠ¥æ”¯æŒ

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. å¼€å¯ Pull Request

## è®¸å¯è¯

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

## è”ç³»æ–¹å¼

- ä½œè€…: saxdyo
- é¡¹ç›®åœ°å€: https://github.com/saxdyo/MovieListwidget
- é—®é¢˜åé¦ˆ: [GitHub Issues](https://github.com/saxdyo/MovieListwidget/issues)